[workspace]
authors = ["Michael Booth <michael@databooth.com.au>"]
channels = ["conda-forge", "https://conda.modular.com/max-nightly"]
name = "mojo-inference-service"
platforms = ["osx-arm64", "linux-64"]
version = "0.1.0"

[activation]
env = { MOJO_PATH = "$PIXI_PROJECT_ROOT/src:$HOME/code/github/databooth/mojo-toml/src:$HOME/code/github/databooth/mojo-dotenv/src" }

[dependencies]
modular = "*"
transformers = ">=4.57.3,<5"
pytorch = ">=2.9.1,<3"
optimum = ">=2.1.0,<3"
onnxruntime = ">=1.22.2,<2"
onnxscript = ">=0.5.6,<0.6"

[tasks]
# Development tasks
build = "mojo build -I $HOME/code/github/databooth/mojo-toml/src -I $HOME/code/github/databooth/mojo-dotenv/src src/main.mojo -o inference-service"
start = "mojo run -I $HOME/code/github/databooth/mojo-toml/src -I $HOME/code/github/databooth/mojo-dotenv/src src/main.mojo"
inference = "mojo run -I $HOME/code/github/databooth/mojo-toml/src -I $HOME/code/github/databooth/mojo-dotenv/src src/main.mojo"
mojo-version = "mojo --version"

# Testing tasks
test = "mojo test tests/"
test-config = "mojo test tests/test_config.mojo"
test-classifier = "mojo test tests/test_classifier.mojo"

# Examples
example = "mojo run examples/example_inference.mojo"

# Linting and formatting
format = "mojo format src/ tests/ examples/"
check = "mojo check src/ tests/ examples/"

# Benchmarking (future)
# bench = "mojo run benchmarks/compare_python.mojo"
